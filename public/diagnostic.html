<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Teams Diagnostic</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .status { margin: 10px 0; padding: 10px; border-radius: 4px; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
    </style>
</head>
<body>
    <h1>Teams Integration Diagnostic</h1>
    <div id="status"></div>
    
    <script type="module">
        const statusDiv = document.getElementById('status');
        
        function addStatus(message, isError = false) {
            const div = document.createElement('div');
            div.className = `status ${isError ? 'error' : 'success'}`;
            div.textContent = message;
            statusDiv.appendChild(div);
        }
        
        try {
            addStatus('✓ Basic HTML loaded');
            
            // Test Teams SDK
            import('@microsoft/teams-js').then(async ({ app }) => {
                addStatus('✓ Teams SDK imported');
                
                try {
                    await app.initialize();
                    addStatus('✓ Teams initialized successfully');
                    
                    const context = await app.getContext();
                    addStatus(`✓ Teams context: ${context.page?.frameContext || 'unknown'}`);
                    
                } catch (e) {
                    addStatus(`✗ Teams init failed: ${e.message}`, true);
                }
            }).catch(e => {
                addStatus(`✗ Teams SDK import failed: ${e.message}`, true);
            });
            
        } catch (e) {
            addStatus(`✗ Script error: ${e.message}`, true);
        }
    </script>
</body>
</html>